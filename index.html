<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Biblioth√®que de jeux de bar</title>
  <meta name="description" content="Une biblioth√®que gratuite et ouverte de jeux de bar : r√®gles, mat√©riel, dur√©e, nombre de joueurs, variantes et conseils de mise en place." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fdfbf7;--card:#fffefc;--muted:#5f5b56;--text:#2c2620;--accent:#c97a3d;--accent2:#946846;--ok:#387f39;--warn:#b08900;--danger:#b54747;
      --radius:12px;--shadow:0 6px 18px rgba(0,0,0,.08)
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:linear-gradient(180deg, var(--bg) 0%, #f3efe7 100%);color:var(--text);font:16px/1.6 Nunito,system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,"Helvetica Neue",Arial}
    a{color:var(--accent)}
    header{background:linear-gradient(90deg, #d7c4a5, #f5ead7);border-bottom:2px solid #e2d3b7}
    .wrap{max-width:1000px;margin:0 auto;padding:20px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:42px;height:42px;border-radius:10px;background:#c97a3d;color:white;font-weight:bold;font-size:20px;display:grid;place-items:center;box-shadow:var(--shadow);text-decoration:none}
    h1{font-size:26px;margin:0;font-family:"Playfair Display",serif;color:var(--accent2)}
    .tagline{color:var(--muted);font-size:15px;margin-top:4px;font-style:italic}

    .controls{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:12px;margin-top:14px}
    .controls input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #e7dccd;background:#fff;color:var(--text);box-shadow:inset 0 1px 0 rgba(0,0,0,.03)}
    /* menus d√©roulants multi-choix */
    .multi{position:relative;background:#fff;border:1px solid #e7dccd;border-radius:12px;padding:0}
    .multi summary{list-style:none;padding:12px 14px;cursor:pointer;display:flex;justify-content:space-between;align-items:center}
    .multi summary::-webkit-details-marker{display:none}
    .multi[open]{box-shadow:var(--shadow)}
    .multi .panel{position:absolute;z-index:30;background:#fff;border:1px solid #eadfce;border-radius:12px;padding:10px;top:calc(100% + 6px);left:0;right:0;display:grid;gap:8px}
    .multi label{display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:8px;transition:background .2s,border-color .2s}
    .multi .panel label:hover{background:#fff5e8}
    /* surbrillance visuelle quand une case est coch√©e */
    .multi .panel label:has(input:checked){background:#fff2df;border:1px solid #e6c9a3}
    .multi input[type=checkbox]{accent-color: var(--accent)}
    .multi summary em{color:#7a5a40;font-style:normal;font-weight:700;font-size:12px}
    .multi summary span{font-weight:800;font-size:12px;letter-spacing:.02em;color:#7a5a40}

    /* Surbrillance pour le jeu al√©atoire + cartes */
    .highlight{outline:2px solid var(--accent2);animation:flash 1s ease-in-out 0s 2 alternate;border-radius:var(--radius)}
    @keyframes flash{from{background:#fff4df} to{background:#ffffff}}

    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-top:20px}
    .card{background:var(--card);border:1px solid #e2d9c9;border-radius:var(--radius);box-shadow:var(--shadow);padding:18px;display:flex;flex-direction:column;gap:10px;transition:box-shadow .2s,transform .12s,border-color .2s,background .2s}
    .card:hover,.card:focus-within{box-shadow:0 10px 28px rgba(0,0,0,.12);border-color:#e3c7a3;background:#fffaf3}
    .card details[open]{background:#fff7ea;border-radius:10px;padding:8px;margin-top:4px}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid #d0c4b0;font-size:12px;color:var(--muted);background:#faf6ef}
    .meta{display:flex;flex-wrap:wrap;gap:8px}
    .title{font-size:19px;font-weight:700;margin:0 0 4px;font-family:"Playfair Display",serif;color:var(--accent2)}
    .desc{color:var(--muted);margin:0}
    .steps{margin:10px 0 0 18px}
    .steps li{margin:6px 0}
    .badges{display:flex;gap:8px;flex-wrap:wrap}

    .toolbar{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
    .btn{background:#f5ead7;border:1px solid #d0c4b0;color:var(--accent2);padding:10px 14px;border-radius:10px;text-decoration:none;font-weight:600;box-shadow:var(--shadow);cursor:pointer}
    .btn:hover{background:#e7dac4}

    footer{margin:40px 0 60px;color:var(--muted);font-size:14px;text-align:center}

    .section{margin-top:36px;padding:20px;background:#fbf7f1;border:1px solid #e2d9c9;border-radius:var(--radius)}

    @media (max-width:1024px){.grid{grid-template-columns:1fr 1fr}.controls{grid-template-columns:1fr 1fr}}
    @media (max-width:680px){.grid{grid-template-columns:1fr}.controls{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="brand">
        <a href="#" id="homeLink" class="logo" aria-label="Accueil ‚Äî r√©initialiser les filtres">üçª</a>
        <div>
          <h1>Biblioth√®que de jeux de bar</h1>
          <div class="tagline">Une ambiance conviviale, des r√®gles simples et du plaisir partag√©.</div>
        </div>
      </div>
      <div class="controls" aria-label="Filtres de recherche">
        <input id="q" type="search" placeholder="Chercher un jeu (ex: fl√©chettes, d√©s, sans mat√©riel)" />

        <details class="multi" id="playersDDL">
          <summary><span>Joueurs</span><em id="playersSummary">Tous</em></summary>
          <div class="panel">
            <label><input type="checkbox" name="players" value="2">2+</label>
            <label><input type="checkbox" name="players" value="3">3+</label>
            <label><input type="checkbox" name="players" value="4">4+</label>
            <label><input type="checkbox" name="players" value="6">6+</label>
            <label><input type="checkbox" name="players" value="8">8+</label>
          </div>
        </details>

        <details class="multi" id="durationDDL">
          <summary><span>Dur√©e</span><em id="durationSummary">Toutes</em></summary>
          <div class="panel">
            <label><input type="checkbox" name="duration" value="<10">&lt;10 min</label>
            <label><input type="checkbox" name="duration" value="10-20">10‚Äì20 min</label>
            <label><input type="checkbox" name="duration" value=">20">&gt;20 min</label>
          </div>
        </details>

        <details class="multi" id="materialDDL">
          <summary><span>Mat√©riel</span><em id="materialSummary">Tous</em></summary>
          <div class="panel">
            <label><input type="checkbox" name="mat" value="rien">Rien</label>
            <label><input type="checkbox" name="mat" value="cartes">Cartes</label>
            <label><input type="checkbox" name="mat" value="d√©s">D√©s</label>
            <label><input type="checkbox" name="mat" value="fl√©chettes">Fl√©chettes</label>
            <label><input type="checkbox" name="mat" value="billard">Billard</label>
            <label><input type="checkbox" name="mat" value="baby-foot">Baby-foot</label>
            <label><input type="checkbox" name="mat" value="gobelets">Gobelets</label>
            <label><input type="checkbox" name="mat" value="capsules">Capsules</label>
            <label><input type="checkbox" name="mat" value="totem">Totem</label>
            <label><input type="checkbox" name="mat" value="sous-bocks">Sous-bocks</label>
          </div>
        </details>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="section" id="ephemeride">
      <h2>√âph√©m√©ride</h2>
      <p id="quote" class="desc">‚Ä¶</p>
    </section>

    <div class="toolbar" style="margin-top:22px;display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
      <div id="count">0 jeu(x)</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn" id="randomBtn" type="button">Jeu al√©atoire</button>
        <a class="btn" href="#proposer">Proposer un jeu</a>
      </div>
    </div>

    <section id="list" class="grid" aria-live="polite"></section>
    <!-- Zone de fiche d√©taill√©e -->
    <section id="detail" class="section" hidden></section>

    <section class="section" id="apropos">
      <h2>√Ä propos</h2>
      <p>Cette biblioth√®que r√©unit des jeux de bar classiques et conviviaux : fl√©chettes, baby-foot, cartes, d√©s, quiz‚Ä¶ L‚Äôobjectif est de retrouver l‚Äôambiance chaleureuse d‚Äôun pub o√π tout le monde peut participer, sans prise de t√™te.</p>
      <ul>
        <li><strong>Gratuit</strong> ‚Äî r√®gles claires et adaptables.</li>
        <li><strong>Avec mod√©ration</strong> ‚Äî certaines variantes incluent de l‚Äôalcool, mais toujours de fa√ßon optionnelle.</li>
        <li><strong>Pour tous</strong> ‚Äî des jeux calmes aux jeux d‚Äôambiance, chacun peut trouver sa place.</li>
      </ul>
    </section>

    <section class="section" id="proposer">
      <h2>Proposer un jeu</h2>
      <p>Vous connaissez un jeu local, une variante ou une r√®gle maison ? Partagez-le en envoyant :</p>
      <p><a class="btn" href="mailto:contact@exemple.com?subject=Proposition%20de%20jeu%20de%20bar">‚úâÔ∏è Envoyer une proposition</a></p>
    </section>

    <footer>
      Fait avec üç∫ et ‚òï ‚Äî Version 1.1 ‚Äî Licence CC BY 4.0
    </footer>
  </main>

  <template id="card-tpl">
    <article class="card">
      <h3 class="title"></h3>
      <p class="desc"></p>
      <div class="meta"></div>
      <details>
        <summary>R√®gles d√©taill√©es</summary>
        <ol class="steps"></ol>
        <div class="badges"></div>
      </details>
    </article>
  </template>

  <script>
    // ===== Donn√©es ‚Äî Jeux de bar (pack v1) =====
    const data = [
      { name: "21", slug: "21", summary: "On compte jusqu‚Äô√† 21‚Ä¶ celui qui dit 21 boit et invente une r√®gle. Chill, mais pi√©geux.", players: 2, duration: 30, noise: "moyen", equipment: [], level: "D√©butant", alcohol: "optionnel", steps: ["Le 1er joueur dit 1 √† 3 nombres √† la suite.","Le suivant reprend et dit 1 √† 3 nombres MAIS pas le m√™me compte que son pr√©d√©cesseur.","Celui qui tombe sur 21 boit et cr√©e une nouvelle r√®gle."], tips:["Mets le tempo pour pousser √† l‚Äôerreur.","Ne rappelle pas trop les r√®gles‚Ä¶ c‚Äôest plus dr√¥le quand √ßa d√©raille."], tags:["ambiance","sans mat√©riel","classique"] },
      { name: "21 D√©s", slug: "21-des", summary: "Lance le d√© et additionne : d√©passer 21, c‚Äôest boire. Clair, net, pr√©cis.", players: 2, duration: 20, noise: "moyen", equipment: ["1 d√©"], level: "D√©butant", alcohol: "optionnel", steps:["Chacun lance le d√© √† son tour et ajoute au total.","Si tu d√©passes 21, tu bois et on repart."], tips:["Se joue tr√®s bien en ‚Äòfond de soir√©e‚Äô en parall√®le d‚Äôun autre jeu."], tags:["d√©s","rapide"] },
      { name: "421", slug: "421", summary: "3 d√©s, 3 lancers. 421 > brelan > suite > paire‚Ä¶ Que le meilleur bluffeur gagne.", players: 2, duration: 30, noise: "moyen", equipment: ["3 d√©s","gobelet (optionnel)"], level: "Tous niveaux", alcohol: "optionnel", steps:["Chaque joueur lance jusqu‚Äô√† 3 fois (en gardant les d√©s choisis).","Comparez les combinaisons : 421 au sommet, puis brelans, suites‚Ä¶","Le perdant boit, le gagnant distribue."], tips:["Un sous-bock fait une bonne piste √† d√©s.","Id√©al en 1v1 tranquille."], tags:["d√©s","classique"] },
      { name: "7 - 14 - 21", slug: "7-14-21", summary: "On chasse les ‚Äò1‚Äô avec 3 d√©s. √Ä 7 et 14, on fixe l‚Äôalcool et les gorg√©es. √Ä 21‚Ä¶ a√Øe.", players: 2, duration: 30, noise: "moyen", equipment: ["3 d√©s"], level: "D√©butant", alcohol: "optionnel", steps:["Lance 3 d√©s. Au moins un ‚Äò1‚Äô ? Ajoute ce nombre au total et rejoue ; sinon, passe.","√Ä 7 : on choisit la boisson ; √† 14 : le nombre de gorg√©es.","Le joueur qui atteint 21 boit ce qui a √©t√© fix√©."], tips:["Si le 0‚Üí7/7‚Üí14/14‚Üí21 se fait d‚Äôun coup, tous les autres boivent."], tags:["d√©s","ambiance"] },
      { name: "9 ou Valet", slug: "9-ou-valet", summary: "Tu devines la carte. Tu rates ? Tu bois. Tu r√©ussis ? Il boit. Simple, efficace.", players: 2, duration: 10, noise: "moyen", equipment: ["52 cartes"], level: "D√©butant", alcohol: "optionnel", steps:["Le donneur demande : ‚Äú9 ou Valet ?‚Äù (ou une autre hauteur).","Le devineur annonce. On retourne : gagnant boit/donne √† boire."], tips:["Ne pr√©viens pas des r√®gles au devineur‚Ä¶ c‚Äôest meilleur √† cru."], tags:["cartes","rapide"] },
      { name: "Autoroute", slug: "autoroute", summary: "Traverser 7 cartes en devinant plus/moins/√©gal. Le bitume est glissant.", players: 2, duration: 10, noise: "moyen", equipment: ["52 cartes"], level: "D√©butant", alcohol: "optionnel", steps:["Pose 7 cartes face cach√©e.","Devine si la suivante est plus, moins ou √©gale ; erreur = tu bois et tu recommences.","√Ä la 4e carte, tu gagnes 2 ‚Äòchances‚Äô bonus."], tips:["Varie la longueur de l‚Äôautoroute selon le niveau."], tags:["cartes","adresse"] },
      { name: "Beer Pong (version soft)", slug: "beer-pong", summary: "Balles + gobelets en triangle. Mets dedans, retire le verre. Oui, c‚Äôest mythique.", players: 4, duration: 30, noise: "fort", equipment: ["2 balles de ping-pong","20 gobelets","table"], level: "D√©butant", alcohol: "optionnel", steps:["Deux pyramides de 10 gobelets, bras sans d√©passer la table pour lancer.","Touch√© = on retire le gobelet ; un rebond est autoris√©.","R√©organisation des gobelets possible 1 fois / partie."], tips:["Mets de l‚Äôeau dans les gobelets et bois dans ton verre : hygi√®ne ++."], tags:["adresse","tournoi","gobelets"] },
      { name: "Belote de comptoir", slug: "belote-de-comptoir", summary: "Belote express avec ench√®res, atout et shot au milieu. Pour les poivrots strat√®ges.", players: 2, duration: 30, noise: "moyen", equipment: ["32 cartes","1 shot (au centre)"], level: "Confirm√©", alcohol: "optionnel", steps:["Chaque joueur re√ßoit 1‚Äì5 cartes (m√™me nombre chacun).","Ench√®res sur le nombre de points, choix de l‚Äôatout, puis plis.","Si le contrat est tenu : donner le shot ; sinon : le boire."], tips:["Clarifiez les variantes avant (belote/rebelote, carte visible, etc.)."], tags:["cartes","strat√©gie"] },
      { name: "Black Jack (maison)", slug: "black-jack", summary: "Approche 21 sans exploser. La banque boit pour tous ses p√©ch√©s.", players: 2, duration: 20, noise: "moyen", equipment: ["52 cartes"], level: "Tous niveaux", alcohol: "optionnel", steps:["Chaque joueur parie des gorg√©es. 2 cartes aux joueurs, 1 √† la banque.","Hit/Stand/Doubler/Split selon ta main ; au-del√† de 21 : perdu.","La banque tire jusqu‚Äô√† ‚â•17, puis compare les scores et boit/ fait boire."], tips:["Le BlackJack (As+10) bat un simple 21."], tags:["cartes","classique"] },
      { name: "Caps", slug: "caps", summary: "Fais tomber la capsule de l‚Äôautre. Si √ßa tombe dans la bouteille : cul-sec !", players: 2, duration: 20, noise: "moyen", equipment: ["2 capsules","bouteilles"], level: "D√©butant", alcohol: "optionnel", steps:["Capsules pos√©es sur les bouteilles ; on lance sa capsule pour faire tomber celle des autres.","Capsule tomb√©e = l‚Äôautre boit ; tomb√©e dans la bouteille = cul-sec."], tips:["Pr√©vois une zone de tir d√©di√©e (√©vite la casse)."], tags:["adresse","capsules"] },
      { name: "Chifoumi", slug: "chifoumi", summary: "Pierre-Feuille-Ciseaux pour r√©gler tout et rien. Shot/gorg√©e en mise l√©g√®re.", players: 2, duration: 10, noise: "faible", equipment: [], level: "D√©butant", alcohol: "optionnel", steps:["Pierre bat Ciseaux, Ciseaux bat Feuille, Feuille bat Pierre.","Joue en manche courte pour d√©partager fissa."], tips:["Parfait pour arbitrer un d√©bat d‚Äôexperts."], tags:["sans mat√©riel","rapide"] },
      { name: "Chifoumi chinois", slug: "chifoumi-chinois", summary: "Chifoumi‚Ä¶ mais en cartes (3√ó6 cartes). Le shot attend le perdant.", players: 2, duration: 20, noise: "moyen", equipment: ["18 cartes (3 signes √ó 6)","1 shot"], level: "D√©butant", alcohol: "optionnel", steps:["Choisir 3 signes (ex : ‚ô†=Pierre, ‚ô£=Feuille, ‚ô¶=Ciseaux).","Chacun r√©v√®le une carte en m√™me temps ; perdant boit le shot.","Jusqu‚Äô√† √©puisement des 3 cartes de chacun."], tips:["Varie le nombre de cartes pour des manches plus longues."], tags:["cartes","duel"] },
      { name: "Chocho√Ø (cercles de cartes)", slug: "chochoi", summary: "Le cercle ne doit pas se briser. Et la pile au sommet doit tenir !", players: 2, duration: 45, noise: "moyen", equipment: ["52 cartes","bouteille (support)","1 shot"], level: "Interm√©diaire", alcohol: "optionnel", steps:["Dispose un cercle de cartes autour d‚Äôune bouteille, pioche sans casser le cercle.","Applique l‚Äôaction li√©e √† la carte (r√®gles sp√©cial ‚Äòpalmier‚Äô).","Finir son tour en posant sa carte sur la bouteille (deux coins d√©passent)."], tips:["Si le cercle casse ou la pile tombe : shot !"], tags:["cartes","ambiance","long"] },
      { name: "Dixit (2 d√©s)", slug: "dixit-des", summary: "Lance 2 d√©s : 3 = cr√©e/supprime r√®gle, 7 = ‚ÄòDixit‚Äô‚Ä¶ et ainsi de suite.", players: 2, duration: 45, noise: "moyen", equipment: ["2 d√©s"], level: "Tous niveaux", alcohol: "optionnel", steps:["Lance 2 d√©s et applique l‚Äôeffet (3=nouvelle r√®gle, 7=Dixit, 9=pr√©c√©dent boit, 10=toi, 11=suivant‚Ä¶).","Double = distribue ce nombre de gorg√©es.","Le ‚Äòprisonnier‚Äô boit quand un 3 sort (jusqu‚Äô√† se lib√©rer en faisant 3)."], tips:["Note les r√®gles invent√©es‚Ä¶ ou pas, c‚Äôest le bazar voulu."], tags:["d√©s","ambiance","r√®gles √©volutives"] },
      { name: "French Banger", slug: "french-banger", summary: "Flip de gobelet en duel : rapproche le shot de l‚Äôadversaire, ou bois.", players: 2, duration: 10, noise: "fort", equipment: ["1 shot","2 gobelets"], level: "D√©butant", alcohol: "optionnel", steps:["Deux joueurs face √† face, shot au milieu ; 3 allumettes comme ‚Äòpaliers‚Äô.","Chaque flip r√©ussi d√©place le shot vers l‚Äôadversaire.","Quand le shot arrive chez toi : tu bois."], tips:["En carton (les gobelets), la plan√®te te dit merci."], tags:["gobelets","duel","rapide"] },
      { name: "Fuck the dealer", slug: "fuck-the-dealer", summary: "Devine la carte du dessus ; le dealer trinque (ou te fait trinquer).", players: 3, duration: 45, noise: "moyen", equipment: ["52 cartes"], level: "Interm√©diaire", alcohol: "optionnel", steps:["Le dealer fait deviner la carte du dessus.","1√®re tentative : juste = dealer boit 5 ; faux = ‚Äòplus/moins‚Äô.","2e tentative : juste = dealer boit 3 ; faux = tu bois l‚Äô√©cart."], tips:["Au 3e √©chec d‚Äôaffil√©e, le r√¥le de dealer peut tourner."], tags:["cartes","bluff"] },
      { name: "Grelote √ßa Picote", slug: "grelote-ca-picote", summary: "D√©fausse rapide en criant des noms. Si tu tra√Ænes, tu trinques.", players: 2, duration: 30, noise: "fort", equipment: ["52 cartes"], level: "Interm√©diaire", alcohol: "optionnel", steps:["3 cartes en main ; on pose sur la derni√®re carte jou√©e (m√™me signe ou m√™me hauteur) en appelant un joueur.","Si carr√© compl√©t√© : ‚ÄòGrelote √ßa picote‚Äô et tu d√©signes qui boit.","Quand plus personne ne peut jouer : dernier appel√© boit l‚Äô√©quivalent des cartes jou√©es."], tips:["Acc√©l√®re le rythme : plus d‚Äôerreurs = plus de rires."], tags:["cartes","r√©flexe","vitesse"] },
      { name: "Jeu des gros nichons", slug: "gros-nichons", summary: "Compter jusqu‚Äô√† 21 avec les pouces directionnels. Oui, le nom est NSFW.", players: 2, duration: 20, noise: "moyen", equipment: [], level: "D√©butant", alcohol: "optionnel", steps:["‚ÄòQui veut jouer‚Ä¶ ?‚Äô Les motiv√©s r√©pondent ‚ÄòChon‚Äô.","Comptez, et pointez le voisin suivant √† gauche/droite avec le pouce.","√Ä 21 : invente une nouvelle r√®gle."], tips:["Variante ‚ÄòBars‚Äô : m√™me principe, autre nom ; ajoute des r√®gles aux nombres cl√©s."], tags:["sans mat√©riel","ambiance"] },
      { name: "Jeu des signes", slug: "jeu-des-signes", summary: "Chaque joueur a un signe. On se passe le ‚Äòtempo‚Äô en rythme. L‚Äôerreur se boit.", players: 2, duration: 20, noise: "moyen", equipment: [], level: "D√©butant", alcohol: "optionnel", steps:["Tous tapent 2√ó genoux + 1√ó mains en rythme.","Le joueur A fait son signe au lieu de taper des mains, puis le signe de B.","B encha√Æne (son signe puis un autre), et ainsi de suite. Rat√© = boit."], tips:["Acc√©l√®re peu √† peu, √ßa craque vite."], tags:["sans mat√©riel","rythme"] },
      { name: "Jeu des verres", slug: "jeu-des-verres", summary: "Relais de flips de verres par √©quipe. Derniers = gorg√©e + √©limination d‚Äôun joueur.", players: 2, duration: 30, noise: "fort", equipment: ["verres (carton)"], level: "D√©butant", alcohol: "optionnel", steps:["√âquipes de tailles √©gales ; chaque joueur doit ‚Äòflipper‚Äô son verre √† l‚Äôendroit.","Derniers √† finir : gorg√©e et un joueur √©limin√© (l‚Äô√©quipe tourne √† effectif r√©duit).","La derni√®re √©quipe en lice gagne."], tips:["Mettez l‚Äôambiance : √ßa fait toute la diff‚Äô."], tags:["gobelets","√©quipe","vitesse"] },
      { name: "Jeu du con", slug: "jeu-du-con", summary: "Minuteur + distribution de gorg√©es. Le dernier √† avoir bu perd (et boit le shot).", players: 2, duration: 20, noise: "moyen", equipment: ["minuteur","1 shot"], level: "D√©butant", alcohol: "optionnel", steps:["D√©marre un chrono commun (‚âà15 s/joueur).","√Ä son tour, on d√©signe quelqu‚Äôun qui boit une gorg√©e.","√Ä la fin du chrono, le dernier √† avoir bu prend le shot."], tips:["Fais parler les gens pour leur faire oublier l‚Äôhorloge."], tags:["ambiance","tempo"] },
      { name: "Jeu du doigt", slug: "jeu-du-doigt", summary: "Doigt sur le verre. Annonce le nombre de doigts restants‚Ä¶ et prie fort.", players: 2, duration: 30, noise: "moyen", equipment: [], level: "D√©butant", alcohol: "optionnel", steps:["Tous posent un doigt sur un support au centre.","Le joueur actif annonce un nombre ; au ‚Äògo‚Äô, chacun enl√®ve ou garde son doigt.","Si l‚Äôannonce est juste, il sort du jeu ; sinon, il boit et reste."], tips:["Variantes ‚Äòpouces‚Äô √† 2‚Äì3 joueurs : chaos garanti."], tags:["sans mat√©riel","psychologie"] },
      { name: "Killer", slug: "killer", summary: "Recharge, tire, prot√®ge-toi. G√®re tes balles et tes boucliers, ou meurs (et bois).", players: 2, duration: 20, noise: "moyen", equipment: [], level: "Interm√©diaire", alcohol: "optionnel", steps:["En rythme (2√ó genoux), choisis : recharger (max 3), tirer, ou bouclier (pas >2 d‚Äôaffil√©e).","Un tir tue sauf bouclier ou tir simultan√© avec balle.","Mort = gorg√©e ; erreur de geste = gorg√©e."], tips:["En multi, tu peux tirer sur 2 cibles si tu as 2 balles."], tags:["sans mat√©riel","duel","r√©flexe"] },
      { name: "Kinito", slug: "kinito", summary: "Annonce de combis au gobelet. Croire ? Ne pas croire ? Bluffer ? (Oui.)", players: 2, duration: 30, noise: "moyen", equipment: ["2 d√©s","gobelet"], level: "Interm√©diaire", alcohol: "optionnel", steps:["Le joueur A lance √† l‚Äôabri et annonce une combinaison ‚â• √† la pr√©c√©dente.","B choisit : croire (et relancer) ou accuser de bluff.","Perdre sur un double = boire la valeur ; sur Kinito‚Ä¶ bon courage."], tips:["Quand √ßa pique, bluffe t√¥t : personne ne s‚Äôy attend."], tags:["d√©s","bluff"] },
      { name: "La bataille", slug: "bataille", summary: "Plus haute carte gagne. En version ‚Äòouverte‚Äô, les shots s‚Äôinvitent.", players: 2, duration: 20, noise: "faible", equipment: ["52 cartes","(option) 2 shots"], level: "D√©butant", alcohol: "optionnel", steps:["Chacun r√©v√®le la 1√®re carte de son paquet ; plus haut gagne.","√âgalit√© : ‚Äòbataille‚Äô (une face cach√©e + une face visible).","Variante ouverte : on g√®re un paquet r√©f√©rent et des shots √† distribuer."], tips:["Pour d√©panner quand on sait plus √† quoi jouer."], tags:["cartes","classique"] },
      { name: "La roulette russe (cartes)", slug: "roulette-russe", summary: "Un intrus dans le paquet : si tu le pioches, tu trinques.", players: 2, duration: 20, noise: "moyen", equipment: ["52 cartes (partiel)","1 shot"], level: "D√©butant", alcohol: "optionnel", steps:["M√©lange des cartes de m√™me couleur + 1 d‚Äôautre couleur, face cach√©e.","Chacun pioche √† son tour ; la carte ‚Äòpi√©g√©e‚Äô fait boire (souvent le shot).","On rem√©lange et on recommence."], tips:["Sur la derni√®re carte‚Ä¶ c‚Äôest double peine."], tags:["cartes","hasard"] },
      { name: "Le 51", slug: "le-51", summary: "Ne pas d√©passer 51 dans le pot commun. Les t√™tes peuvent aider (ou pas).", players: 2, duration: 30, noise: "moyen", equipment: ["32 cartes","1 shot"], level: "Interm√©diaire", alcohol: "optionnel", steps:["4 cartes face cach√©e par joueur ; on ajoute tour √† tour une carte au pot.","Si le total d√©passe 51, le poseur boit le shot.","Valeurs sp√©ciales : 9=0, 10=10 ou -10, As=1 ou 11, etc."], tips:["Parfait en d√©but de soir√©e, calcul mental friendly."], tags:["cartes","compte"] },
      { name: "Le 63√®me parall√®le", slug: "63-parallele", summary: "Ench√®res pour annoncer sans d√©passer 63. Le monde est petit, la sanction grande.", players: 2, duration: 20, noise: "moyen", equipment: ["52 cartes"], level: "Interm√©diaire", alcohol: "optionnel", steps:["√Ä ton tour, regarde la carte du dessus : annonce et pose (le total grimpe) ou passe.","Dernier en jeu compte : <63 ‚Üí autres boivent ; >63 ‚Üí lui boit (√ó nb joueurs / paliers).","√âgal √† 63 : tout le monde (sauf le dernier) prend un shot."], tips:["Les t√™tes valent 10 ; √ßa grimpe tr√®s vite."], tags:["cartes","ench√®res"] },
      { name: "Le Viking", slug: "le-viking", summary: "Un chef, des rameurs, des casques qui tournent. Se tromper, c‚Äôest boire.", players: 4, duration: 20, noise: "fort", equipment: [], level: "D√©butant", alcohol: "optionnel", steps:["Le chef fait son geste (casque + va-et-vient), ses voisins rament √† droite/gauche.","Le chef passe le casque √† quelqu‚Äôun : il devient chef instantan√©ment.","Ajoute un 2e chef si tout le monde suit : cerveau grill√© assur√©."], tips:["√Ä 2 chefs, les bras partent dans tous les sens. Excellent."], tags:["sans mat√©riel","ambiance","rythme"] },
      { name: "PMU (course de valets)", slug: "pmu", summary: "Parie des gorg√©es sur ton ‚Äòcheval‚Äô (un valet). √Ä chaque couleur tir√©e, il avance.", players: 2, duration: 20, noise: "moyen", equipment: ["52 cartes"], level: "D√©butant", alcohol: "optionnel", steps:["Aligne 4 valets (ligne de d√©part), pr√©pare 5 paliers.","Retourne des cartes : la couleur fait avancer le valet associ√©.","Le premier qui franchit le dernier palier gagne."], tips:["Fais les paris d‚Äôabord (responsablement)."], tags:["cartes","pari","ambiance"] }
    ];

    // ===== pack v2 (ajouts tir√©s du PDF) =====
    const more = [
      { name: "Jeu du paquet", slug: "jeu-du-paquet", summary: "Fais tourner un paquet sur le bord de la table. Selon comment il retombe, √ßa boit.", players: 2, duration: 20, noise: "moyen", equipment: ["paquet (clopes ou cartes)","table"], level: "D√©butant", alcohol: "optionnel", steps: ["Place le paquet de profil, 2/3 sur la table, 1/3 dans le vide.","Tape le bord qui d√©passe pour le faire tourner (‚â• 1/2 tour) et retomber.","Plat = tu bois et rejoues ; sur la tranche = joueur suivant ; haut/bas = tu distribues une gorg√©e."], tips: ["Variante cumul : tant que tu poses sur un bord, on ajoute +1 gorg√©e au ‚Äòcompte‚Äô."], tags: ["adresse","rapide"] },
      { name: "Le chemin", slug: "le-chemin", summary: "Retourne les cartes palier par palier (1-2-3-2-1) sans te faire renvoyer au d√©but.", players: 2, duration: 25, noise: "moyen", equipment: ["52 cartes"], level: "Interm√©diaire", alcohol: "optionnel", steps: ["Forme un chemin de cartes face cach√©e : 1-2-3-2-1.","T√™te = retour au palier 1 ; 7 = passe ton tour ; > palier 3 : tu as 2 ‚Äòvies‚Äô.", "Partie termin√©e quand la pioche manque pour reconstituer le chemin."], tips: ["C‚Äôest violent : joue en 1v1 si quelqu‚Äôun t‚Äô√©nerve (perdant = gros tarif)."], tags: ["cartes","difficile"] },
      { name: "Le Crocodile", slug: "le-crocodile", summary: "Grand chaos de gobelets et balles : √©vite de te faire ‚Äòcroquer‚Äô par les verres remplis.", players: 4, duration: 40, noise: "fort", equipment: ["2 balles de ping-pong","gobelets","table"], level: "D√©butant", alcohol: "optionnel", steps: ["Dispose de nombreux verres au centre (l√©g√®rement remplis). 2 balles en jeu.","Les joueurs font rebondir une balle pour la loger dans un verre.","Balle dans un verre plein = tu bois ce verre ; fautes de jeu = bois au centre. Fin : plus de verres."], tips: ["Joue dehors : la table va prendre cher."], tags: ["gobelets","vitesse","ambiance"] },
      { name: "Menteur", slug: "menteur", summary: "Annonce des cartes face cach√©e. On te croit‚Ä¶ ou on t‚Äôappelle menteur.", players: 2, duration: 30, noise: "moyen", equipment: ["52 cartes"], level: "D√©butant", alcohol: "optionnel", steps: ["Choisis une hauteur demand√©e, pose 1+ carte(s) face cach√©e.","Suivant : ajoute ou dit ‚ÄòMenteur‚Äô. On r√©v√®le et on boit selon le r√©sultat.","Le premier sans carte fait boire ; le dernier avec des cartes finit son verre."], tips: ["Bluffe souvent, √ßa passe (trop)."], tags: ["cartes","bluff"] },
      { name: "Michon Michette", slug: "michon-michette", summary: "√Ä ‚ÄòMichette‚Äô, tourne la main. √ätre dans la minorit√©, c‚Äôest boire.", players: 3, duration: 15, noise: "fort", equipment: [], level: "D√©butant", alcohol: "optionnel", steps: ["Tous en cercle, main verticale.","Au ‚ÄòMichette‚Äô, paume vers le haut ou vers le bas.","Ceux en minorit√© boivent."], tips: ["Impair, c‚Äôest encore mieux."], tags: ["sans mat√©riel","ambiance"] },
      { name: "Mort subite", slug: "mort-subite", summary: "Compose des paires plus vite que les autres et distribue depuis le pot.", players: 2, duration: 20, noise: "moyen", equipment: ["52 cartes"], level: "Interm√©diaire", alcohol: "optionnel", steps: ["S√©pare cartes ‚Äòsanctions‚Äô (‚â§6) et ‚Äòjeu‚Äô (‚â•7).","Chaque manche : on r√©v√®le ses cartes jeu en m√™me temps qu‚Äôun paquet ‚Äòr√©f√©rence‚Äô.","Plus de paires = gagne la manche ; pioche dans le pot pour distribuer autant de gorg√©es que la valeur."], tips: ["Il faut 2 fois de la chance : au jeu et au pot !"], tags: ["cartes","r√©flexe"] },
      { name: "Pim pam Poum", slug: "pim-pam-poum", summary: "PIM, PAM, puis POUM en d√©signant quelqu‚Äôun. Rater le rythme = boire.", players: 2, duration: 20, noise: "moyen", equipment: [], level: "D√©butant", alcohol: "optionnel", steps: ["Un joueur dit PIM, le suivant PAM.","Troisi√®me dit POUM en pointant quelqu‚Äôun qui reprend √† PIM.","Erreur de mot ou de cible = boit."], tips: ["Feinte en disant PAM en montrant quelqu‚Äôun‚Ä¶ et POUM sur toi-m√™me."], tags: ["sans mat√©riel","rythme"] },
      { name: "Plus grand", slug: "plus-grand", summary: "Au d√©, celui qui a le plus grand nombre boit (d√©parts en duel si √©galit√©).", players: 2, duration: 10, noise: "faible", equipment: ["1 d√©"], level: "D√©butant", alcohol: "optionnel", steps: ["Chacun lance ; le plus grand boit.","√âgalit√© ‚Üí d√©partage au d√© (peu importe la valeur)."], tips: ["Parfait pour patienter entre deux ‚Äògros‚Äô jeux."], tags: ["d√©s","rapide"] },
      { name: "Pour combien", slug: "pour-combien", summary: "Parie un nombre pour faire un gage ; si on tombe pareil, tu le fais.", players: 2, duration: 10, noise: "moyen", equipment: [], level: "D√©butant", alcohol: "optionnel", steps: ["A propose un gage √† B : ‚ÄòPour combien‚Ä¶ ?‚Äô.","B choisit un nombre N ; en m√™me temps, A et B annoncent un nombre entre 1 et N.","Si √©galit√© : B fait le gage ; sinon, rien. Variante : inversion des r√¥les avec N‚Äô < N."], tips: ["Fixe un max (20) et pense ‚Äò2‚Äô pour clore les d√©bats üòâ"], tags: ["sans mat√©riel","pari"] },
      { name: "Pyramide", slug: "pyramide", summary: "Bluffe avec tes 4 cartes pendant que la pyramide se d√©voile (gorg√©es par √©tage).", players: 2, duration: 30, noise: "moyen", equipment: ["52 cartes"], level: "Interm√©diaire", alcohol: "optionnel", steps: ["Monte une pyramide (6-5-4-3-2-1) et distribue 4 cartes par joueur.","√Ä chaque carte retourn√©e, accuse/donne des gorg√©es selon tes cartes en main (bluff possible).","En fin de pyramide, chacun r√©v√®le ses 4 cartes ; erreur = cul-sec."], tips: ["Le 6e √©tage peut valoir cul-sec : chauffe-toi."], tags: ["cartes","bluff"] },
      { name: "Rouge ou noir", slug: "rouge-ou-noir", summary: "4 questions crescendo (couleur, plus/moins, int√©rieur/ext√©rieur, signe) puis un ‚ÄòH‚Äô.", players: 2, duration: 45, noise: "moyen", equipment: ["52 cartes"], level: "Interm√©diaire", alcohol: "optionnel", steps: ["Le dealer pose 4 questions successives aux joueurs (1 √† 4 gorg√©es).","Puis dispose 12 cartes en H : on retourne et on boit/donne par √©tage, la barre centrale = cul-sec.","Variante : 3 colonnes (prendre/donner/les deux)."], tips: ["√âvite la violence : limite √† 1 gorg√©e par r√©v√©lation si besoin."], tags: ["cartes","ambiance"] },
      { name: "Shot du destin", slug: "shot-du-destin", summary: "3 cartes tir√©es : rouges +, noires ‚Äì, Joker = shot. Le destin tranche.", players: 2, duration: 5, noise: "faible", equipment: ["52 cartes"], level: "D√©butant", alcohol: "optionnel", steps: ["A tire 3 cartes (ordre A-B-A).","Rouges = points positifs ; noires = n√©gatifs ; on fait le total.","Total >0 : B boit ; <0 : A boit ; 0 : personne. Joker : shot imm√©diat."], tips: ["Fais 2 manches en inversant l‚Äôordre pour ‚Äò√©quilibrer le karma‚Äô."], tags: ["cartes","hasard","rapide"] },
      { name: "Tchik-tchack-tchouk", slug: "tchik-tchack-tchouk", summary: "Chifoumi avec ‚Äòconfirmation‚Äô directionnelle. Deviner la t√™te, sinon tu bois.", players: 2, duration: 15, noise: "moyen", equipment: [], level: "D√©butant", alcohol: "optionnel", steps: ["Fais un chifoumi (‚ÄòTchik‚ÄìTchak‚ÄìTchouk‚Äô).","Le gagnant ‚Äòpointe‚Äô et redonne ‚ÄòTchik‚ÄìTchak‚ÄìTchouk‚Äô ; √† ‚ÄòTchouk‚Äô, il indique une direction.","Si l‚Äôautre regarde la m√™me direction 1√ó : 1 gorg√©e ; 2√ó : demi cul-sec."], tips: ["Ne laisse pas deviner ton timing : feinte !"], tags: ["sans mat√©riel","duel"] },
      { name: "Titanic", slug: "titanic", summary: "Pose des cartes (‚ô£0, ‚ô¶1, ‚ô•2, ‚ô†3) sans faire couler le total cible.", players: 2, duration: 15, noise: "moyen", equipment: ["52 cartes (sans t√™tes)"], level: "D√©butant", alcohol: "optionnel", steps: ["Distribue 4 cartes par joueur ; total cible = 2√ó nb de joueurs (‚â•9).","√Ä tour de r√¥le, pose une carte sur le ‚ÄòTitanic‚Äô (pot).","Celui qui d√©passe le total le ‚Äòcoule‚Äô et boit autant que de joueurs."], tips: ["Le croupier = dernier √† √™tre mont√© sur un bateau (ou avec le plus gros gla√ßon)."], tags: ["cartes","compte"] },
      { name: "Toc Toc Toc Squiz", slug: "toc-toc-toc-squiz", summary: "Passe la balle imaginaire (‚Äòsquiz‚Äô), saute (‚Äòbang‚Äô), change le sens (‚Äòbing‚Äô)‚Ä¶ et retiens un th√®me d‚Äôanimaux !", players: 2, duration: 45, noise: "fort", equipment: [], level: "Interm√©diaire", alcohol: "optionnel", steps: ["Lance : ‚ÄòToc Toc Toc‚Ä¶ squiz‚Äô (frappe/‚Äòenvoie‚Äô une balle imaginaire).","Options : ‚Äòsquiz‚Äô (passe √† droite), ‚Äòbang‚Äô (saute un joueur), ‚Äòbing‚Äô (change le sens).","Variante/bonus : √† chaque passe, dis un animal sans r√©p√©ter ; erreur = tu bois."], tips: ["Garde des animaux improbables en t√™te."], tags: ["sans mat√©riel","rythme","m√©moire"] },
      { name: "Ventes aux ench√®res", slug: "ventes-aux-encheres", summary: "Anglaise, hollandaise, cach√©e, payante : remporte le ‚Äòlot‚Äô pour distribuer des gorg√©es.", players: 2, duration: 5, noise: "moyen", equipment: [], level: "D√©butant", alcohol: "optionnel", steps: ["Choisis un mode d‚Äôench√®re (anglaise, hollandaise, cach√©e, payante).","Le plus offrant gagne la distribution (ex : 10 gorg√©es).","Encha√Æne des mini-ventes tout au long de la soir√©e."], tips: ["En ‚Äòpayante‚Äô, on boit sa mise pour surench√©rir. Co√ªteux‚Ä¶ et dr√¥le."], tags: ["ambiance","pari"] }
    ];
    
    data.push(...more);

    // ===== S√©lecteurs & √©tat =====
    const list = document.getElementById('list');
    const tpl = document.getElementById('card-tpl');
    const q = document.getElementById('q');
    const count = document.getElementById('count');
    const randomBtn = document.getElementById('randomBtn');
    const homeLink = document.getElementById('homeLink');
    const playerChecks = document.querySelectorAll('input[name="players"]');
    const durationChecks = document.querySelectorAll('input[name="duration"]');
    const matChecks = document.querySelectorAll('input[name="mat"]');

    // √âph√©m√©ride ‚Äî phrases du jour (√©chantillon)
    const ephemeridePhrases = [
      "La meilleure r√®gle du bar : on s'amuse, on partage.",
      "Aujourd'hui, on d√©couvre un nouveau jeu.",
      "Un petit d√©fi vaut mieux que mille excuses.",
      "Rire fort, jouer fair-play.",
      "Le hasard fait bien les jeux.",
      "On m√©lange les √©quipes, on double le fun.",
      "La victoire est douce, la revanche encore plus.",
      "Un tour rapide ? On dit oui !",
      "Le meilleur mat√©riel, c'est l'envie de jouer.",
      "On essaye, on rate, on recommence.",
      "Ce soir, un classique et une nouveaut√©.",
      "Le bar est une table de jeu g√©ante.",
      "Qui perd paye‚Ä¶ un sourire.",
      "On range les t√©l√©phones, on sort les d√©s.",
      "Une manche courte en appelle une autre.",
      "On joue pour cr√©er des souvenirs.",
      "La chance sourit aux audacieux.",
      "Le secret d'une bonne soir√©e : de bons partenaires.",
      "Aujourd'hui, c'est vous le ma√Ætre du quiz.",
      "Un peu de strat√©gie, beaucoup de rires.",
      "R√®gles simples, plaisir maximum.",
      "Le fair-play, c'est la classe.",
      "Un nouveau jeu par semaine, au moins !",
      "On applaudit les beaux coups.",
      "La meilleure revanche : rejouer.",
      "Faites une pause, lancez un d√©.",
      "Tout le monde peut gagner une manche.",
      "La soir√©e commence avec un ¬´ Jeu al√©atoire ¬ª"
    ];
    function dayOfYear(d){ const start=new Date(d.getFullYear(),0,0); const diff=d-start; const oneDay=1000*60*60*24; return Math.floor(diff/oneDay); }
    function renderEphemeride(){ const i=dayOfYear(new Date()); const t=ephemeridePhrases[i % ephemeridePhrases.length]; const el=document.getElementById('quote'); if(el) el.textContent=t; }

    let lastResults = [];

    function durationBucket(mins){
      if(mins<10) return '<10';
      if(mins<=20) return '10-20';
      return '>20';
    }

    function getMaterialCats(g){
      const text = (g.equipment.join(' ') + ' ' + g.name + ' ' + (g.tags||[]).join(' ')).toLowerCase();
      const cats = new Set();
      if(g.equipment.length===0 || text.includes('sans mat√©riel') || text.includes('sans materiel') || (g.tags||[]).includes('sans mat√©riel')) cats.add('rien');
      if(text.includes('carte')) cats.add('cartes');
      if(text.includes('d√©s') || text.includes('des') ) cats.add('d√©s');
      if(text.includes('cible') || text.includes('fl√©chette') || text.includes('flechette')) cats.add('fl√©chettes');
      if(text.includes('billard')) cats.add('billard');
      if(text.includes('baby‚Äëfoot') || text.includes('baby-foot') || text.includes('babyfoot')) cats.add('baby-foot');
      if(text.includes('gobelet')) cats.add('gobelets');
      if(text.includes('capsule')) cats.add('capsules');
      if(text.includes('totem')) cats.add('totem');
      if(text.includes('sous‚Äëbock') || text.includes('sous-bock')) cats.add('sous-bocks');
      return Array.from(cats);
    }

    function render(items){
      list.innerHTML='';
      items.forEach(g=>{
        const node = tpl.content.cloneNode(true);
        const article = node.querySelector('article');
        const slug = (g.slug || g.name.toLowerCase().replace(/[^a-z0-9]+/g,'-'));
        article.dataset.slug = slug;

        node.querySelector('.title').textContent = g.name;
        node.querySelector('.desc').textContent = g.summary;

        const meta = node.querySelector('.meta');
        const pills = [ `${g.players}+ joueurs`, `${g.duration} min`, `Niveau : ${g.level}` ];
        pills.forEach(p=>{ const span=document.createElement('span'); span.className='pill'; span.textContent=p; meta.appendChild(span); });

        const steps = node.querySelector('.steps');
        (g.steps||[]).forEach(s=>{const li=document.createElement('li');li.textContent=s;steps.appendChild(li)});

        const badges = node.querySelector('.badges');
        const equip = document.createElement('span'); equip.className='pill'; equip.textContent = `Mat√©riel : ${g.equipment.join(', ')||'‚Äî'}`; badges.appendChild(equip);
        const alcohol = document.createElement('span'); alcohol.className='pill'; alcohol.textContent = `Alcool : ${g.alcohol||'optionnel'}`; badges.appendChild(alcohol);
        const tags = document.createElement('span'); tags.className='pill'; tags.textContent = `Tags : ${(g.tags||[]).join(', ')}`; badges.appendChild(tags);

        // Lien Fiche d√©taill√©e
        const more = document.createElement('a');
        more.className = 'btn';
        more.href = '#jeu/' + slug;
        more.textContent = 'Fiche d√©taill√©e';
        article.appendChild(more);

        list.appendChild(node);
      });
      lastResults = items;
      count.textContent = `${items.length} jeu(x)`;
    }

    function filter(){
      const query = q.value.trim().toLowerCase();
      const psel = Array.from(document.querySelectorAll('input[name="players"]:checked')).map(i=>parseInt(i.value));
      const dsel = Array.from(document.querySelectorAll('input[name="duration"]:checked')).map(i=>i.value);
      const msel = Array.from(document.querySelectorAll('input[name="mat"]:checked')).map(i=>i.value);

      const items = data.filter(g=>{
        const hay = [g.name, g.summary, (g.tags||[]).join(' '), (g.equipment||[]).join(' '), g.level].join(' ').toLowerCase();
        const qok = !query || hay.includes(query);
        const pok = psel.length===0 || psel.some(v=> g.players >= v);
        const dok = dsel.length===0 || dsel.includes(durationBucket(g.duration));
        const mats = getMaterialCats(g);
        const mok = msel.length===0 || msel.some(m=> mats.includes(m));
        return qok && pok && dok && mok;
      });

      render(items);
      window.scrollTo({top:0,behavior:'smooth'});
    }

    function updateSummary(id, values){
      const el = document.getElementById(id);
      el.textContent = values.length ? values.join(', ') : (id.includes('players')? 'Tous' : (id.includes('duration')? 'Toutes' : 'Tous'));
    }
    function updateAllSummaries(){
      const p = Array.from(document.querySelectorAll('input[name="players"]:checked')).map(i=>i.value+'+');
      const d = Array.from(document.querySelectorAll('input[name="duration"]:checked')).map(i=>i.value);
      const m = Array.from(document.querySelectorAll('input[name="mat"]:checked')).map(i=>i.value);
      updateSummary('playersSummary', p);
      updateSummary('durationSummary', d);
      updateSummary('materialSummary', m);
    }

    // Listeners filtres
    q.addEventListener('input', ()=>{ filter(); });
    playerChecks.forEach(el=>el.addEventListener('change', ()=>{ updateAllSummaries(); filter(); }));
    durationChecks.forEach(el=>el.addEventListener('change', ()=>{ updateAllSummaries(); filter(); }));
    matChecks.forEach(el=>el.addEventListener('change', ()=>{ updateAllSummaries(); filter(); }));

    // Fermer un dropdown si clic en dehors
    document.addEventListener('click', (e)=>{
      document.querySelectorAll('details.multi[open]').forEach(d=>{ if(!d.contains(e.target)) d.removeAttribute('open'); });
    });

    // Jeu al√©atoire (surbrillance incluse)
    randomBtn.addEventListener('click', ()=>{
      const pool = lastResults.length ? lastResults : data;
      if(!pool.length) return;
      const pick = pool[Math.floor(Math.random()*pool.length)];
      const slug = (pick.slug || pick.name.toLowerCase().replace(/[^a-z0-9]+/g,'-'));
      const el = document.querySelector(`[data-slug="${slug}"]`);
      if(el){ el.classList.add('highlight'); el.scrollIntoView({behavior:'smooth', block:'center'}); setTimeout(()=>el.classList.remove('highlight'), 2000); }
      // Si on est en vue d√©tail, on redirige vers la fiche
      if(!el){ location.hash = '#jeu/' + slug; }
    });

    // Clic logo = reset filtres & haut de page
    homeLink.addEventListener('click', (e)=>{
      e.preventDefault();
      q.value='';
      document.querySelectorAll('details.multi input[type="checkbox"]').forEach(c=>c.checked=false);
      updateAllSummaries();
      filter();
      window.scrollTo({top:0,behavior:'smooth'});
    });

    // ===== "Pages" de d√©tail =====
    const controls = document.querySelector('.controls');
    const toolbar  = document.querySelector('.toolbar');
    const detail   = document.getElementById('detail');

    function slugify(t){ return (t||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,''); }

    function ficheHTML(g){
      const equip = (g.equipment||[]).join(', ') || '‚Äî';
      const tags  = (g.tags||[]).join(', ');
      const tips  = (g.tips||[]).map(t=>`<li>${t}</li>`).join('') || '<li>Amusez-vous bien ‚ú®</li>';
      const steps = (g.steps||[]).map(s=>`<li>${s}</li>`).join('') || '<li>Pas de r√®gles‚Ä¶ c‚Äôest freestyle.</li>';
      return `
        <a class="btn" href="#" id="backBtn">‚Üê Retour √† la liste</a>
        <h2 style="margin-top:10px">${g.name}</h2>
        <p class="desc" style="margin:6px 0 14px">${g.summary||''}</p>
        <div class="meta" style="margin-bottom:10px">
          <span class="pill">${g.players}+ joueurs</span>
          <span class="pill">${g.duration} min</span>
          <span class="pill">Niveau : ${g.level||'‚Äî'}</span>
        </div>
        <div class="badges" style="margin-bottom:14px">
          <span class="pill">Mat√©riel : ${equip}</span>
          <span class="pill">Alcool : ${g.alcohol||'optionnel'}</span>
          <span class="pill">Tags : ${tags}</span>
        </div>
        <h3>R√®gles d√©taill√©es</h3>
        <ol class="steps">${steps}</ol>
        <h3>Conseils</h3>
        <ul>${tips}</ul>
        <div style="display:flex;gap:8px;margin-top:14px;flex-wrap:wrap">
          <a class="btn" href="#jeu/${g.slug||slugify(g.name)}">Partager cette fiche</a>
          <a class="btn" href="#" id="randomFromDetail">Jeu al√©atoire</a>
        </div>
      `;
    }

    function showDetail(g){
      controls.hidden = true; toolbar.hidden  = true; list.hidden = true;
      detail.hidden   = false; detail.innerHTML = ficheHTML(g);
      detail.querySelector('#backBtn').addEventListener('click', (e)=>{ e.preventDefault(); location.hash = ''; });
      const rnd = detail.querySelector('#randomFromDetail');
      if(rnd){ rnd.addEventListener('click', (e)=>{ e.preventDefault(); const pick = data[Math.floor(Math.random()*data.length)]; location.hash = '#jeu/' + (pick.slug || slugify(pick.name)); }); }
    }

    function goHome(){
      detail.hidden = true; controls.hidden = false; toolbar.hidden = false; list.hidden = false;
      if(!list.children.length) render(data);
      window.scrollTo({top:0,behavior:'smooth'});
    }

    function resolveBySlug(s){ return data.find(g => (g.slug || slugify(g.name)) === s); }

    function onHashChange(){
      const m = location.hash.match(/^#jeu\/(.+)$/);
      if(m){ const slug = decodeURIComponent(m[1]); const g = resolveBySlug(slug); if(g){ showDetail(g); return; } }
      goHome();
    }

    window.addEventListener('hashchange', onHashChange);

    // Init
    render(data);
    updateAllSummaries();
    renderEphemeride();
    onHashChange(); // ouvre une fiche si l‚ÄôURL en contient une
  </script>
</body>
</html>
